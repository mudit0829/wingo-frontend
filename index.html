<!DOCTYPE html>
<html>
<head>
  <title>WinGo Demo - Login/Register</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f4f4f4; }
    .box { background: white; padding: 20px; max-width: 400px; margin: auto; border-radius: 10px; box-shadow: 0 0 10px #ccc; }
    input, select { width: 100%; margin: 10px 0; padding: 10px; }
    button { width: 100%; padding: 10px; background: #007bff; color: white; border: none; }
    .msg { margin-top: 10px; font-weight: bold; }
  </style>
</head>
<body>

<div class="box">
  <h2>Login or Register</h2>

  <select id="mode">
    <option value="login">Login</option>
    <option value="register">Register</option>
  </select>

  <input type="text" id="username" placeholder="Username" />
  <input type="password" id="password" placeholder="Password" />
  <select id="role">
    <option value="user">User</option>
    <option value="admin">Admin</option>
  </select>

  <button onclick="submitForm()">Submit</button>

  <div class="msg" id="msg"></div>
</div>

<script>
const API = "https://wingo-backend-nqk5.onrender.com/api/users";

async function submitForm() {
  const mode = document.getElementById("mode").value;
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;
  const role = document.getElementById("role").value;
  const msg = document.getElementById("msg");

  const url = API + (mode === "login" ? "/login" : "/register");
  const body = { username, password, ...(mode === "register" && { role }) };

  const res = await fetch(url, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify(body)
  });

  const data = await res.json();
  msg.innerText = data.message || "Done";

  // Optional: redirect to game page
  if (data.message && data.message.includes("successful")) {
    localStorage.setItem("role", data.role || role);
    setTimeout(() => {
      window.location.href = role === "admin" ? "admin.html" : "game.html";
    }, 1000);
  }
}
</script>

</body>
</html>
