<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>WinGo Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      padding-top: 50px;
    }
    #timer {
      font-size: 24px;
      color: red;
      margin-bottom: 20px;
    }
    #game-result {
      font-size: 28px;
      font-weight: bold;
      color: green;
    }
  </style>
</head>
<body>
  <h2>Welcome to WinGo</h2>
  <h3 id="timer">Next Result in: 30s</h3>
  <div id="game-result">Waiting for result...</div>

  <script>
    const API = 'https://wingo-backend-nqk5.onrender.com';
    let countdown = 30;

    function updateTimer() {
      document.getElementById("timer").textContent = `Next Result in: ${countdown}s`;
      countdown--;

      if (countdown < 0) {
        countdown = 30;
        loadCurrentResult();
      }
    }

    async function loadCurrentResult() {
      try {
        const res = await fetch(`${API}/api/rounds`);
        const data = await res.json();
        const recent = data.reverse().find(r => r.result !== null);
        if (recent) {
          document.getElementById("game-result").textContent =
            `Round ${recent._id.slice(-4)} Result: ${recent.result}`;
        } else {
          document.getElementById("game-result").textContent = "Waiting for result...";
        }
      } catch (err) {
        console.error("Error loading result:", err);
        document.getElementById("game-result").textContent = "Error loading result";
      }
    }

    setInterval(updateTimer, 1000);
    loadCurrentResult();
  </script>
</body>
</html>
